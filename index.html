<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HILE_WROX - Sorgu Paneli</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { background-color: #0f172a; color: white; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        .navbar { background-color: #1e293b; border-bottom: 1px solid #334155; }
        .sidebar { background-color: #1e293b; height: 100vh; position: fixed; left: -250px; top: 0; width: 250px; transition: 0.3s; z-index: 1000; padding-top: 60px; border-right: 1px solid #334155; }
        .sidebar.active { left: 0; }
        .sidebar a { padding: 15px; text-decoration: none; font-size: 1.1rem; color: #cbd5e1; display: block; transition: 0.2s; }
        .sidebar a:hover { background-color: #334155; color: white; }
        .main-content { transition: 0.3s; padding: 20px; }
        .card { background-color: #1e293b; border: 1px solid #334155; color: white; margin-bottom: 20px; }
        .btn-primary { background-color: #3b82f6; border: none; }
        .result-box { background-color: #0f172a; border-radius: 8px; padding: 15px; border-left: 4px solid #3b82f6; margin-top: 10px; }
        #overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 999; }
    </style>
</head>
<body>

<nav class="navbar navbar-dark sticky-top">
    <div class="container-fluid">
        <button class="navbar-toggler" type="button" onclick="toggleSidebar()">
            <span class="navbar-toggler-icon"></span>
        </button>
        <a class="navbar-brand ms-3" href="#"><b>@HILE_WROX</b> PANEL</a>
        <div class="d-flex align-items-center">
            <span class="badge bg-primary">VIP AKTİF</span>
        </div>
    </div>
</nav>

<div class="sidebar" id="sidebar">
    <a href="#" onclick="showSection('home')"><i class="fa fa-home me-2"></i> Ana Sayfa</a>
    <a href="#" onclick="showSection('soyagaci')"><i class="fa fa-dna me-2"></i> Soyağacı</a>
    <a href="#" onclick="showSection('adsoyadpro')"><i class="fa fa-user me-2"></i> Ad Soyad İl PRO</a>
    <a href="#" onclick="showSection('tcpro')"><i class="fa fa-id-card me-2"></i> TC PRO</a>
    <a href="#" onclick="showSection('sulale')"><i class="fa fa-tree me-2"></i> Sülale</a>
    <hr>
    <a href="#" style="color: #ef4444;"><i class="fa fa-sign-out-alt me-2"></i> Çıkış</a>
</div>

<div id="overlay" onclick="toggleSidebar()"></div>

<div class="main-content container mt-4">
    
    <div id="section-soyagaci" class="sorgu-section" style="display: none;">
        <div class="card shadow">
            <div class="card-body">
                <h4 class="card-title text-primary"><i class="fa fa-dna"></i> Soyağacı Sorgu</h4>
                <p class="text-muted small">Kişinin tüm alt-üst soy bilgilerini listeler.</p>
                <input type="text" id="tc_input" class="form-control mb-3" placeholder="TC Kimlik No Girin">
                <button class="btn btn-primary w-100" onclick="performQuery('soyagaci')">Sorgula</button>
            </div>
        </div>
    </div>

    <div id="section-adsoyadpro" class="sorgu-section" style="display: none;">
        <div class="card shadow">
            <div class="card-body">
                <h4 class="card-title text-success"><i class="fa fa-user"></i> Ad Soyad İl PRO</h4>
                <div class="row g-2">
                    <div class="col-md-4"><input type="text" id="ad_pro" class="form-control" placeholder="Ad"></div>
                    <div class="col-md-4"><input type="text" id="soyad_pro" class="form-control" placeholder="Soyad"></div>
                    <div class="col-md-4"><input type="text" id="il_pro" class="form-control" placeholder="İl"></div>
                </div>
                <button class="btn btn-success w-100 mt-3" onclick="performQuery('adsoyadpro')">Detaylı Sorgula</button>
            </div>
        </div>
    </div>

    <div id="results" class="mt-4"></div>
</div>

<script>
    function toggleSidebar() {
        document.getElementById('sidebar').classList.toggle('active');
        const overlay = document.getElementById('overlay');
        overlay.style.display = overlay.style.display === 'block' ? 'none' : 'block';
    }

    function showSection(section) {
        document.querySelectorAll('.sorgu-section').forEach(s => s.style.display = 'none');
        const target = document.getElementById('section-' + section);
        if(target) target.style.display = 'block';
        toggleSidebar();
    }

    async function performQuery(type) {
        const resultDiv = document.getElementById('results');
        resultDiv.innerHTML = '<div class="text-center"><div class="spinner-border text-primary"></div><p>Sorgulanıyor...</p></div>';
        
        let url = "";
        let params = new URLSearchParams();

        if(type === 'soyagaci') {
            url = "https://punisher.alwaysdata.net/apiservices/soyagaci.php";
            params.append('tc', document.getElementById('tc_input').value);
        } else if(type === 'adsoyadpro') {
            url = "https://punisher.alwaysdata.net/apiservices/adsoyadpro.php";
            params.append('ad', document.getElementById('ad_pro').value);
            params.append('soyad', document.getElementById('soyad_pro').value);
            params.append('il', document.getElementById('il_pro').value);
        }

        try {
            const response = await fetch(url + "?" + params.toString());
            const data = await response.json();
            
            // Botun içindeki derin tarama mantığı
            let results = data.soyagaci || data.data || data.results || (Array.isArray(data) ? data : [data]);
            
            if(results && results.length > 0) {
                let html = `<h5>Bulunan Kayıtlar (${results.length})</h5>`;
                results.forEach(item => {
                    html += `
                    <div class="result-box">
                        <b>${(item.Yakinlik || item.iliski || "Kişi").toUpperCase()}</b><br>
                        ${item.Ad || item.Adi} ${item.Soyad || item.Soyadi}<br>
                        TC: ${item.TC || item.tc_no || "Bilinmiyor"}<br>
                        Durum: ${item.OlumTarihi ? 'VEFAT ('+item.OlumTarihi+')' : 'HAYATTA'}
                    </div>`;
                });
                resultDiv.innerHTML = html;
            } else {
                resultDiv.innerHTML = '<div class="alert alert-warning">Kayıt bulunamadı.</div>';
            }
        } catch (error) {
            resultDiv.innerHTML = '<div class="alert alert-danger">Sunucu hatası veya API erişimi engellendi.</div>';
        }
    }

    // İlk açılış
    showSection('soyagaci');
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
